{% extends 'base.html' %}
{% block title %}
    {{ title }}
{% endblock %}

{% block content %}
    <form method="post" action="." enctype="multipart/form-data">

        {{ crsf_token }}
        <article class="message is-danger">
            <div class="message-header">
                <p>Are you sure you want to delete this {{ name }} {{ object.name }}?</p>
            </div>
            <div class="message-body">
                If you delete this {{ name }} you will not be able to recover, this action has no correction, take the
                necessary measures before deleting this.
            </div>
        </article>

        <div class="control">
            <button type="submit" class="button is-danger">Delete</button>

            <a class="button is-info" href="{{ list_url }}">Cancel</a>
        </div>

    </form>

    <script>

            $('form').on('submit', function (e) {
                e.preventDefault();
                var parameters = $(this).serializeArray();

                $.ajax({
                    url: window.location.pathname,
                    type: 'POST',
                    data: parameters,
                    dataType: 'json'
                }).done(function (data) {
                    if (!data.hasOwnProperty('error')) {
                        location.href = '{{ list_url }}';
                        return false;
                    }
                    message_error(data.error);
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    alert(textStatus + ': ' + errorThrown);
                }).always(function (data) {

                });

            });
        </script>

{% endblock %}